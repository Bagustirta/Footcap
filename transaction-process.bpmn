<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI"
             xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC"
             xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI"
             xmlns:camunda="http://camunda.org/schema/1.0/bpmn"
             id="Definitions_1"
             targetNamespace="http://bpmn.io/schema/bpmn">
  <process id="OnlineTransactionProcess" isExecutable="true">
    <laneSet>
      <lane id="UserLane" name="User">
        <flowNodeRef>StartEvent_User</flowNodeRef>
        <flowNodeRef>AddToCart</flowNodeRef>
        <flowNodeRef>ItemAdded</flowNodeRef>
        <flowNodeRef>CheckItem</flowNodeRef>
        <flowNodeRef>UploadPayment</flowNodeRef>
        <flowNodeRef>StatusProcessing_User</flowNodeRef>
        <flowNodeRef>ConfirmReceived</flowNodeRef>
        <flowNodeRef>StatusReceived</flowNodeRef>
        <flowNodeRef>GiveReview</flowNodeRef>
        <flowNodeRef>EndEvent_User</flowNodeRef>
      </lane>
      <lane id="AdminLane" name="Admin">
        <flowNodeRef>StartEvent_Admin</flowNodeRef>
        <flowNodeRef>VerifyPayment</flowNodeRef>
        <flowNodeRef>Gateway_Valid</flowNodeRef>
        <flowNodeRef>RejectPayment</flowNodeRef>
        <flowNodeRef>StatusProcessing_Admin</flowNodeRef>
        <flowNodeRef>WaitUserConfirm</flowNodeRef>
      </lane>
    </laneSet>

    <!-- User -->
    <startEvent id="StartEvent_User" name="Login"/>
    <task id="AddToCart" name="Tambah ke Keranjang"/>
    <task id="ItemAdded" name="Barang Masuk ke Keranjang"/>
    <task id="CheckItem" name="Centang Barang yang Ingin Dibeli"/>
    <task id="UploadPayment" name="Upload Bukti Pembayaran"/>
    <task id="StatusProcessing_User" name="Ubah Status: Sedang Diproses"/>

    <!-- Admin -->
    <startEvent id="StartEvent_Admin" name="Pembayaran Masuk"/>
    <task id="VerifyPayment" name="Verifikasi Pembayaran"/>
    <exclusiveGateway id="Gateway_Valid" name="Apakah Valid?"/>
    <task id="RejectPayment" name="Tolak Pembayaran"/>
    <task id="StatusProcessing_Admin" name="Ubah Status: Sedang Diproses"/>
    <task id="WaitUserConfirm" name="Tunggu Konfirmasi User"/>

    <!-- Back to User -->
    <task id="ConfirmReceived" name="Konfirmasi Barang Sudah Diterima"/>
    <task id="StatusReceived" name="Ubah Status: Barang Sudah Diterima"/>
    <task id="GiveReview" name="Beri Ulasan"/>
    <endEvent id="EndEvent_User" name="Selesai"/>

    <!-- Flow -->
    <sequenceFlow id="flow1" sourceRef="StartEvent_User" targetRef="AddToCart"/>
    <sequenceFlow id="flow2" sourceRef="AddToCart" targetRef="ItemAdded"/>
    <sequenceFlow id="flow3" sourceRef="ItemAdded" targetRef="CheckItem"/>
    <sequenceFlow id="flow4" sourceRef="CheckItem" targetRef="UploadPayment"/>
    <sequenceFlow id="flow5" sourceRef="UploadPayment" targetRef="StatusProcessing_User"/>
    <sequenceFlow id="flow6" sourceRef="StatusProcessing_User" targetRef="StartEvent_Admin"/>
    <sequenceFlow id="flow7" sourceRef="StartEvent_Admin" targetRef="VerifyPayment"/>
    <sequenceFlow id="flow8" sourceRef="VerifyPayment" targetRef="Gateway_Valid"/>
    <sequenceFlow id="flow9" sourceRef="Gateway_Valid" targetRef="RejectPayment" name="Tidak Valid"/>
    <sequenceFlow id="flow10" sourceRef="Gateway_Valid" targetRef="StatusProcessing_Admin" name="Valid"/>
    <sequenceFlow id="flow11" sourceRef="StatusProcessing_Admin" targetRef="WaitUserConfirm"/>
    <sequenceFlow id="flow12" sourceRef="WaitUserConfirm" targetRef="ConfirmReceived"/>
    <sequenceFlow id="flow13" sourceRef="ConfirmReceived" targetRef="StatusReceived"/>
    <sequenceFlow id="flow14" sourceRef="StatusReceived" targetRef="GiveReview"/>
    <sequenceFlow id="flow15" sourceRef="GiveReview" targetRef="EndEvent_User"/>
  </process>
</definitions>
